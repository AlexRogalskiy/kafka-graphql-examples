<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="634px" preserveAspectRatio="none" style="width:1730px;height:634px;" version="1.1" viewBox="0 0 1730 634" width="1730px" zoomAndPan="magnify"><defs/><g><!--MD5=[edc2c29f12934937e9dee71e2d189b28]
entity tr--><path d="M12,91 C12,71 161,71 161,71 C161,71 310,71 310,91 L310,169.9375 C310,189.9375 161,189.9375 161,189.9375 C161,189.9375 12,189.9375 12,169.9375 L12,91 " fill="#ADD8E6" style="stroke: #000000; stroke-width: 3.0;"/><path d="M12,91 C12,111 161,111 161,111 C161,111 310,111 310,91 " fill="none" style="stroke: #000000; stroke-width: 3.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="258" x="32" y="167.2422">transaction</text><!--MD5=[8e9b2d9d80e066cced8e5d90e9bdea61]
entity c--><rect fill="#FFFF00" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="272" x="807" y="80"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="797" y="90"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="797" y="160.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="232" x="827" y="148.2422">consumer</text><!--MD5=[979c31051cf8d07bdf927ed864b836ec]
entity cl--><ellipse cx="1369" cy="453" fill="#FFFFFF" rx="16" ry="16" style="stroke: #A80036; stroke-width: 4.0;"/><path d="M1369,469 L1369,523 M1343,485 L1395,485 M1369,523 L1343,553 M1369,523 L1395,553 " fill="none" style="stroke: #A80036; stroke-width: 4.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="124" x="1307" y="607.2422">client</text><!--MD5=[99db986d38fb499b252ed01955165f04]
entity kc--><rect fill="#D3D3D3" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="166" x="1542" y="80"/><rect fill="#D3D3D3" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1532" y="90"/><rect fill="#D3D3D3" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1532" y="160.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="126" x="1562" y="148.2422">kafka</text><!--MD5=[694f580618a8ff0a20e3fd904d058a88]
entity sp--><rect fill="#FFFF00" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="430" x="336" y="476"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="326" y="486"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="326" y="556.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="390" x="356" y="544.2422">schema-provider</text><!--MD5=[ceaf0cd2ce4ad636a55921864d5ee2bc]
reverse link tr to c--><path d="M321.0392,130 C464.0936,130 671.4404,130 806.7354,130 " fill="none" id="tr&lt;-c" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="310.8522,130,328.8522,138,320.8522,130,328.8522,122,310.8522,130" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="424" x="346.5" y="110.2422">insert transactions</text><!--MD5=[55cb83ca2a74855f56e7a3dc1128cf48]
reverse link c to kc--><path d="M1090.0196,130 C1227.9194,130 1429.2364,130 1541.4774,130 " fill="none" id="c&lt;-kc" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1079.3738,130,1097.3738,138,1089.3738,130,1097.3738,122,1079.3738,130" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="240" x="1190.5" y="50.2422">consumes</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="390" x="1115.5" y="111.1797">BalanceChanged</text><!--MD5=[94120e2ee7c3943604d2e7dbc6bddc31]
link sp to cl--><path d="M776.5596,526 C950.616,526 1180.5786,526 1296.1236,526 " fill="none" id="sp-cl" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1306.2682,526,1288.2682,518,1296.2682,526,1288.2682,534,1306.2682,526" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="766.4546,526,784.4546,534,776.4546,526,784.4546,518,766.4546,526" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="468" x="802.5" y="446.2422">queries or subscribe</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="342" x="802.5" y="507.1797">to transactions</text><!--MD5=[5b9b4e6ad0ac870675818f129b06e9c6]
reverse link tr to sp--><path d="M226.741,196.7524 C304.3744,275.5802 431.7408,404.906 501.4996,475.738 " fill="none" id="tr&lt;-sp" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="219.387,189.2852,226.3175,207.7234,226.4039,196.4101,237.7172,196.4965,219.387,189.2852" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="278" x="393" y="299.2422">sql query on</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="298" x="393" y="360.1797">derived state</text><!--MD5=[a9e274f941e496d3d2b249e342953251]
link c to sp--><path d="M895.1064,180.7602 C848.163,230.269 774.3422,307.4752 709,373 C677.1844,404.9044 641.1296,439.9038 611.5032,468.3666 " fill="none" id="c-&gt;sp" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="604.1162,475.4562,622.6424,468.7644,611.3311,468.5319,611.5635,457.2206,604.1162,475.4562" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="382" x="903" y="299.2422">send transaction</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="538" x="825" y="360.1797">for active subscriptions</text><!--MD5=[1add019159253ae3657bca994d16d4ea]
@startuml
skinparam shadowing false
skinparam defaultFontName Roboto
skinparam defaultFontSize 26

database transaction as tr #LightBlue
component consumer as c #Yellow
actor client as cl #White
component kafka as kc #LightGrey

component "schema-provider" as sp #Yellow

tr <- c :insert transactions
c <- kc :consumes\nBalanceChanged
sp <-> cl :queries or subscribe\lto transactions
tr <- - sp :sql query on\lderived state
c - -> sp :send transaction\nfor active subscriptions


@enduml

PlantUML version 1.2019.10(Fri Sep 13 22:53:03 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+10-b304.69
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>